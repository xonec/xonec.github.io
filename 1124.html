<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>PVE虚拟机模板 | 导航站</title>
<meta name="theme-color" content="#2C2E2F">
<meta name="keywords">
<meta name="description" content="将虚拟机制作成模板，可以在后续新建虚拟机时快速从模板中创建，减少系统安装配置时间。">
<meta property="og:type" content="article">
<meta property="og:url" content="http://158666.xyz/1124.html"> 
<meta property="og:title" content="PVE虚拟机模板 | 导航站">
<meta property="og:description" content="将虚拟机制作成模板，可以在后续新建虚拟机时快速从模板中创建，减少系统安装配置时间。">
<meta property="og:image" content="https://i0.hdslb.com/bfs/article/2f1f6d4f3d566e91f2d506cf6896204798d455c9.png@942w_668h_progressive.webp">
<meta property="og:site_name" content="导航站">
<link rel="shortcut icon" href="http://158666.xyz/wp-content/themes/webstackpro/images/favicon.png">
<link rel="apple-touch-icon" href="http://158666.xyz/wp-content/themes/webstackpro/images/app-ico.png">
<meta name="robots" content="noindex, nofollow">
<link rel="dns-prefetch" href="//ssl.captcha.qq.com">
<link rel="dns-prefetch" href="//use.fontawesome.com">
<link rel="stylesheet" id="wp-block-library-css" href="http://158666.xyz/wp-includes/css/dist/block-library/style.min.css?ver=6.2.2" type="text/css" media="all">
<link rel="stylesheet" id="classic-theme-styles-css" href="http://158666.xyz/wp-includes/css/classic-themes.min.css?ver=6.2.2" type="text/css" media="all">
<style id="global-styles-inline-css" type="text/css">body{--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--duotone--dark-grayscale: url('#wp-duotone-dark-grayscale');--wp--preset--duotone--grayscale: url('#wp-duotone-grayscale');--wp--preset--duotone--purple-yellow: url('#wp-duotone-purple-yellow');--wp--preset--duotone--blue-red: url('#wp-duotone-blue-red');--wp--preset--duotone--midnight: url('#wp-duotone-midnight');--wp--preset--duotone--magenta-yellow: url('#wp-duotone-magenta-yellow');--wp--preset--duotone--purple-green: url('#wp-duotone-purple-green');--wp--preset--duotone--blue-orange: url('#wp-duotone-blue-orange');--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}body .is-layout-flow > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}body .is-layout-flow > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}body .is-layout-flow > .aligncenter{margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}body .is-layout-constrained > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}body .is-layout-constrained > .aligncenter{margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > :where(:not(.alignleft):not(.alignright):not(.alignfull)){max-width: var(--wp--style--global--content-size);margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > .alignwide{max-width: var(--wp--style--global--wide-size);}body .is-layout-flex{display: flex;}body .is-layout-flex{flex-wrap: wrap;align-items: center;}body .is-layout-flex > *{margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
.wp-block-navigation a:where(:not(.wp-element-button)){color: inherit;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}
.wp-block-pullquote{font-size: 1.5em;line-height: 1.6;}</style>
<link rel="stylesheet" id="iconfont-css" href="http://158666.xyz/wp-content/themes/webstackpro/css/iconfont.css?ver=2.0406" type="text/css" media="all">
<link rel="stylesheet" id="font-awesome-css" href="//use.fontawesome.com/releases/v5.13.0/css/all.css?ver=2.0406" type="text/css" media="all">
<link rel="stylesheet" id="font-awesome4-css" href="//use.fontawesome.com/releases/v5.13.0/css/v4-shims.css?ver=2.0406" type="text/css" media="all">
<link rel="stylesheet" id="bootstrap-css" href="http://158666.xyz/wp-content/themes/webstackpro/css/bootstrap.min.css?ver=2.0406" type="text/css" media="all">
<link rel="stylesheet" id="lightbox-css" href="http://158666.xyz/wp-content/themes/webstackpro/css/jquery.fancybox.min.css?ver=2.0406" type="text/css" media="all">
<link rel="stylesheet" id="style-css" href="http://158666.xyz/wp-content/themes/webstackpro/css/style.css?ver=2.0406" type="text/css" media="all">
<script type="text/javascript" src="http://158666.xyz/wp-content/themes/webstackpro/js/jquery.min.js?ver=2.0406" id="jquery-js"></script>
<link rel="canonical" href="http://158666.xyz/1124.html">
<link rel="alternate" type="application/json+oembed" href="http://158666.xyz/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fhttp%3A%2F%2F158666.xyz%2F1124.html">
<link rel="alternate" type="text/xml+oembed" href="http://158666.xyz/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fhttp%3A%2F%2F158666.xyz%2F1124.html#038;format=xml">
<meta name="bmi-version" content="1.2.9">
</head> 
<body class="io-black-mode">
   <div class="page-container">
      

        <div id="sidebar" class="sticky sidebar-nav fade ">
            <div class="modal-dialog h-100  sidebar-nav-inner">
                <div class="sidebar-logo border-bottom border-color">
                    <!-- logo -->
                    <div class="logo overflow-hidden">
                        <a href="http://158666.xyz/" class="logo-expanded">
                            <img src="http://158666.xyz/wp-content/themes/webstackpro/images/logo_l@2x.png" height="40" class="d-none" alt="导航站">
						    <img src="http://158666.xyz/wp-content/themes/webstackpro/images/logo@2x.png" height="40" alt="导航站">
                        </a>
                        <a href="http://158666.xyz/" class="logo-collapsed">
                            <img src="http://158666.xyz/wp-content/themes/webstackpro/images/logo-dark_collapsed@2x.png" height="40" class="d-none" alt="导航站">
						    <img src="http://158666.xyz/wp-content/themes/webstackpro/images/logo-collapsed@2x.png" height="40" alt="导航站">
                        </a>
                    </div>
                    <!-- logo end -->
                </div>
                <div class="sidebar-menu flex-fill">
                    <div class="sidebar-scroll">
                        <div class="sidebar-menu-inner">
                            <ul>
                                                                        <li class="sidebar-item">
                                                <a href="http://158666.xyz/#search" class="smooth">
                                                   <i class="iconfont icon-search  icon-fw icon-lg mr-2"></i>
                                                   <span>搜索</span>
                                                </a>
                                            </li> 
                                                                                <li class="sidebar-item">
                                            <a href="javascript:;">
                                               <i class="fa fa-star icon-fw icon-lg mr-2"></i>
                                               <span>视频娱乐</span>
                                               <i class="iconfont icon-arrow-r-m sidebar-more text-sm"></i>
                                            </a>
                                            <ul>
                                                                                                
                                                <li>
                                                    <a href="http://158666.xyz/#term-168" class="smooth"><span>在线</span></a>
                                                </li>
                                                                                                
                                                <li>
                                                    <a href="http://158666.xyz/#term-169" class="smooth"><span>动漫</span></a>
                                                </li>
                                                                                                
                                                <li>
                                                    <a href="http://158666.xyz/#term-170" class="smooth"><span>下载</span></a>
                                                </li>
                                                                                                
                                                <li>
                                                    <a href="http://158666.xyz/#term-171" class="smooth"><span>不可说</span></a>
                                                </li>
                                                                                            </ul>
                                        </li>
                                                                        <li class="sidebar-item">
                                            <a href="javascript:;">
                                               <i class="fa fa-eercast icon-fw icon-lg mr-2"></i>
                                               <span>自定义父级</span>
                                               <i class="iconfont icon-arrow-r-m sidebar-more text-sm"></i>
                                            </a>
                                            <ul>
                                                                                                
                                                <li>
                                                    <a href="http://158666.xyz/#term-50" class="smooth"><span>休闲游戏x小信息</span></a>
                                                </li>
                                                                                                
                                                <li>
                                                    <a href="http://158666.xyz/#term-55" class="smooth"><span>RPG</span></a>
                                                </li>
                                                                                                
                                                <li>
                                                    <a href="http://158666.xyz/#term-58" class="smooth"><span>角色扮演</span></a>
                                                </li>
                                                                                                
                                                <li>
                                                    <a href="http://158666.xyz/#term-57" class="smooth"><span>暗黑</span></a>
                                                </li>
                                                                                            </ul>
                                        </li>
                                 
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="border-top py-2 border-color">
                    <div class="flex-bottom">
                        <ul> 
                            <li id="menu-item-222" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-222 sidebar-item"><a href="http://158666.xyz/include">
        <i class="fas fa-weight icon-fw icon-lg mr-2"></i>
                <span>申请收录</span></a></li>
 
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="main-content flex-fill page">
		<div id="header" class="page-header big sticky">
			<div class="navbar navbar-expand-md">
                <div class="container-fluid p-0">

                    <a href="http://158666.xyz/" class="navbar-brand d-md-none">
						<img src="http://158666.xyz/wp-content/themes/webstackpro/images/logo-dark_collapsed@2x.png" class="logo-light" alt="导航站">
						<img src="http://158666.xyz/wp-content/themes/webstackpro/images/logo-collapsed@2x.png" class="logo-dark d-none" alt="导航站">
                    </a>
                    
                    <div class="collapse navbar-collapse order-2 order-md-1">
                        <div class="header-mini-btn">
                            <label>
                                <input id="mini-button" type="checkbox" checked>
                                <svg viewbox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"> 
                                    <path class="line--1" d="M0 40h62c18 0 18-20-17 5L31 55"></path>
                                    <path class="line--2" d="M0 50h80"></path>
                                    <path class="line--3" d="M0 60h62c18 0 18 20-17-5L31 45"></path>
                                </svg>
                            </label>
                        
                        </div>
                                                
                    <!-- 天气  -->
                    <div id="tp-weather-widget"></div>
                      <script>(function(a,h,g,f,e,d,c,b){b=function(){d=h.createElement(g);c=h.getElementsByTagName(g)[0];d.src=e;d.charset="utf-8";d.async=1;c.parentNode.insertBefore(d,c)};a["SeniverseWeatherWidgetObject"]=f;a[f]||(a[f]=function(){(a[f].q=a[f].q||[]).push(arguments)});a[f].l=+new Date();if(a.attachEvent){a.attachEvent("onload",b)}else{a.addEventListener("load",b,false)}}(window,document,"script","SeniverseWeatherWidget","//cdn.sencdn.com/widget2/static/js/bundle.js?t="+parseInt((new Date().getTime() / 100000000).toString(),10)));
                        window.SeniverseWeatherWidget('show', {
                          flavor: "slim",
                          location: "WTSQQYHVQ973",
                          geolocation: true,
                          language: "zh-Hans",
                          unit: "c",
                          theme: "auto",
                          token: "2d2b0015-6055-42c9-b686-40963fdc0fc4",
                          hover: "enabled",
                          container: "tp-weather-widget"
                        })</script>
                    <!-- 天气 end -->
                        						<ul class="navbar-nav site-menu mr-4">
                            <li id="menu-item-283" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-283"><a href="http://158666.xyz/blog">博客</a></li>
<li id="menu-item-272" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-272"><a href="#">关于</a></li>
 
						</ul>
                    </div>
                    
                    <ul class="nav navbar-menu text-xs order-1 order-md-2">
                                                <!-- 一言 -->
						<li class="nav-item mr-3 mr-lg-0 d-none d-lg-block">
							<div class="text-sm overflowClip_1">
                                <script src="//v1.hitokoto.cn/?encode=js&select=%23hitokoto" defer></script> 
                                <span id="hitokoto"></span> 
							</div>
						</li>
                        <!-- 一言 end -->
                                                						<li class="nav-item d-md-none mobile-menu ml-4">
							<a href="javascript:" id="sidebar-switch" data-toggle="modal" data-target="#sidebar"><i class="iconfont icon-classification icon-2x"></i></a>
						</li>
                    </ul>
				</div>
            </div>
        </div>
<div id="content" class="container my-4 my-md-5">
	<div class="row">
		<div class="col-lg-8">
    	    <div class="panel card">
			<div class="card-body">
				<div class="panel-header mb-4">
    	        	    	        	<h1 class="h3 mb-3">PVE虚拟机模板</h1>
    	        	<div class="d-flex flex-fill text-muted text-sm pb-4 border-bottom border-t">
    	        	<span class="mr-3 d-none d-sm-block"><a href="http://158666.xyz/pve"><i class="iconfont icon-classification"></i> PVE</a></span>    	        	<span class="mr-3 d-none d-sm-block"><i class="iconfont icon-time"></i> 5小时前</span>
					<span class="mr-3"><a href="http://158666.xyz/author/2" title="xonec"><i class="iconfont icon-user-circle"></i> xonec</a></span>
					<div class="flex-fill"></div>
					                	<span class="mr-3"><a class="smooth-n" href="#comments"> <i class="iconfont icon-comment"></i> 0</a></span>
                	<span class="mr-3"><a class="btn-like btn-link-like " href="javascript:;" post_like data-id="1124"><i class="iconfont icon-like"></i> <span class="like-count">0</span></a></span>
					</div>
    	        </div>
				    	        <div class="panel-body mt-2"> 
					<h1>0.前期准备</h1>
<p>将虚拟机制作成模板，可以在后续新建虚拟机时快速从模板中创建，减少系统安装配置时间。</p>
<p>本文将使用 Debian 的云镜像 <code>debian-11-genericcloud-amd64.qcow2</code> 作为模板虚拟机的镜像。</p>
<p>访问 Debian Official Cloud Images 官方网站，下载最新版 <code>Bullseye</code> 云镜像以及对应的校验文件。</p>
<blockquote>
<p>Debian Official Cloud Images: <a href="https://cloud.debian.org/images/cloud/" target="_blank" rel="nofollow">https://cloud.debian.org/images/cloud/</a></p>
</blockquote>
<a href="https://i0.hdslb.com/bfs/article/2f1f6d4f3d566e91f2d506cf6896204798d455c9.png@942w_668h_progressive.webp" alt="PVE虚拟机模板" data-fancybox="images" data-caption="PVE虚拟机模板" target="_blank" rel="nofollow"><img decoding="async" data-src="https://i0.hdslb.com/bfs/article/2f1f6d4f3d566e91f2d506cf6896204798d455c9.png@942w_668h_progressive.webp" src="http://158666.xyz/$loadimg_url" alt="PVE虚拟机模板"></a>
<p>该虚拟机模板主要作为内网 DNS 服务器使用，并会安装 Adguard Home 。</p>
<h1>1.创建虚拟机</h1>
<p><strong>1.1.常规</strong></p>
<p>登录到 PVE 后台后，进入新建虚拟机流程，并勾选底部 “高级” ，打开虚拟机创建页面的高级选项。</p>
<p>节点即本机，<code>VM ID</code> 和 <code>名称</code> 可以自由定义。</p>
<a href="https://i0.hdslb.com/bfs/article/0ab5ef778bf8be2109b1339623b43f4e520e76c3.png@942w_669h_progressive.webp" alt="PVE虚拟机模板" data-fancybox="images" data-caption="PVE虚拟机模板" target="_blank" rel="nofollow"><img decoding="async" data-src="https://i0.hdslb.com/bfs/article/0ab5ef778bf8be2109b1339623b43f4e520e76c3.png@942w_669h_progressive.webp" src="http://158666.xyz/$loadimg_url" alt="PVE虚拟机模板"></a>
<p><strong>1.2.操作系统</strong>  </p>
<p>无需使用任何安装介质。</p>
<p>操作系统类别选择 <code>Linux</code> 、版本选择 <code>5.x - 2.6 Kernel</code> 即可。</p>
<a href="https://i0.hdslb.com/bfs/article/6149dc8374053bb6c4156c087835c4a60cdf43ee.png@942w_669h_progressive.webp" alt="PVE虚拟机模板" data-fancybox="images" data-caption="PVE虚拟机模板" target="_blank" rel="nofollow"><img decoding="async" data-src="https://i0.hdslb.com/bfs/article/6149dc8374053bb6c4156c087835c4a60cdf43ee.png@942w_669h_progressive.webp" src="http://158666.xyz/$loadimg_url" alt="PVE虚拟机模板"></a>
<p><strong>1.3.系统</strong></p>
<p>系统部分需要修改一些内容，以满足 Debian 使用 <code>UEFI</code> 启动需求。</p>
<p>显卡选择 <code>默认</code>，图中使用的 <code>SPICE</code> 仅供测试。</p>
<p>机型一般选择 <code>默认</code> 即可，使用 <code>q35</code> 主要为了测试 <code>UEFI</code> 启动。</p>
<p>SCSI 控制器选择 <code>VirtIO SCSI single</code> ，勾选 <code>Qemu代理</code> 选项。</p>
<p>在固件处需要针对 <code>UEFI</code> 进行调整，BIOS 选择 <code>OVMF (UEFI)</code> ，勾选 <code>添加EFI磁盘</code> ，EFI 存储选择 <code>local-lvm</code> ：</p>
<a href="https://i0.hdslb.com/bfs/article/7f3c4686cc95fc36c52dfc64e728a718c5b1fd65.png@942w_668h_progressive.webp" alt="PVE虚拟机模板" data-fancybox="images" data-caption="PVE虚拟机模板" target="_blank" rel="nofollow"><img decoding="async" data-src="https://i0.hdslb.com/bfs/article/7f3c4686cc95fc36c52dfc64e728a718c5b1fd65.png@942w_668h_progressive.webp" src="http://158666.xyz/$loadimg_url" alt="PVE虚拟机模板"></a>
<p><strong>1.4.磁盘</strong>  </p>
<p>一般情况下，如果该虚拟机仅为 ADH 服务器，<code>16G</code> 的磁盘空间足够使用。</p>
<p>由于使用 Cloud Image 制作虚拟机模板，此处删除所有磁盘：</p>
<a href="https://i0.hdslb.com/bfs/article/461d83920a75a69a1d31be905e9cfbef7e47a980.png@942w_666h_progressive.webp" alt="PVE虚拟机模板" data-fancybox="images" data-caption="PVE虚拟机模板" target="_blank" rel="nofollow"><img decoding="async" data-src="https://i0.hdslb.com/bfs/article/461d83920a75a69a1d31be905e9cfbef7e47a980.png@942w_666h_progressive.webp" src="http://158666.xyz/$loadimg_url" alt="PVE虚拟机模板"></a>
<p><strong>1.5.CPU</strong>  </p>
<p>CPU类别选择 <code>host</code> ，核心根据物理 CPU 核心数进行酌情设置。</p>
<p>若 PVE 服务器内有多颗物理 CPU ，则推荐启用 <code>NUMA</code> ：</p>
<a href="https://i0.hdslb.com/bfs/article/8488e8be74865fb43e65b8d7657f8e4c58b5df1c.png@942w_665h_progressive.webp" alt="PVE虚拟机模板" data-fancybox="images" data-caption="PVE虚拟机模板" target="_blank" rel="nofollow"><img decoding="async" data-src="https://i0.hdslb.com/bfs/article/8488e8be74865fb43e65b8d7657f8e4c58b5df1c.png@942w_665h_progressive.webp" src="http://158666.xyz/$loadimg_url" alt="PVE虚拟机模板"></a>
<p><strong>1.6.内存</strong>  </p>
<p>内存一般 2G 足够使用，关闭 <code>Ballooning</code> 设备选项：</p>
<a href="https://i0.hdslb.com/bfs/article/13a369d4b3ae7533d5b442fa59484155caf93844.png@942w_669h_progressive.webp" alt="PVE虚拟机模板" data-fancybox="images" data-caption="PVE虚拟机模板" target="_blank" rel="nofollow"><img decoding="async" data-src="https://i0.hdslb.com/bfs/article/13a369d4b3ae7533d5b442fa59484155caf93844.png@942w_669h_progressive.webp" src="http://158666.xyz/$loadimg_url" alt="PVE虚拟机模板"></a>
<p><strong>1.7.网络</strong>  </p>
<p>在 PVE 的 网络设置 中，曾创建了一个没有桥接任何物理网口的内部网桥。</p>
<p>并且该网桥接口为主路由 RouterOS 的 LAN 的成员接口。</p>
<p>因此 Debian 虚拟机的网络设备选择该内部网桥即可，演示环境为 <code>vmbr4</code> ：</p>
<a href="https://i0.hdslb.com/bfs/article/caa80c1fadeb28e401c403209799eb952582ea44.png@942w_669h_progressive.webp" alt="PVE虚拟机模板" data-fancybox="images" data-caption="PVE虚拟机模板" target="_blank" rel="nofollow"><img decoding="async" data-src="https://i0.hdslb.com/bfs/article/caa80c1fadeb28e401c403209799eb952582ea44.png@942w_669h_progressive.webp" src="http://158666.xyz/$loadimg_url" alt="PVE虚拟机模板"></a>
<p>取消网口的 <code>防火墙</code> ，并根据虚拟机 vCPU 数，指定 <code>Multiqueue</code> 的数量，演示环境为 <code>2</code> ：</p>
<a href="https://i0.hdslb.com/bfs/article/5c9dc9de3410579134e48d432f6b9d431412959c.png@942w_666h_progressive.webp" alt="PVE虚拟机模板" data-fancybox="images" data-caption="PVE虚拟机模板" target="_blank" rel="nofollow"><img decoding="async" data-src="https://i0.hdslb.com/bfs/article/5c9dc9de3410579134e48d432f6b9d431412959c.png@942w_666h_progressive.webp" src="http://158666.xyz/$loadimg_url" alt="PVE虚拟机模板"></a>
<p><strong>1.8.确认</strong>  </p>
<p>接下来查看设置总览，确认无误，即可点击 “完成” ：</p>
<a href="https://i0.hdslb.com/bfs/article/6f48daa1558e388c2a2eb8ef4a7cd0d93f52a9ee.png@942w_666h_progressive.webp" alt="PVE虚拟机模板" data-fancybox="images" data-caption="PVE虚拟机模板" target="_blank" rel="nofollow"><img decoding="async" data-src="https://i0.hdslb.com/bfs/article/6f48daa1558e388c2a2eb8ef4a7cd0d93f52a9ee.png@942w_666h_progressive.webp" src="http://158666.xyz/$loadimg_url" alt="PVE虚拟机模板"></a>
<h1>2.调整虚拟机硬件参数</h1>
<p><strong>2.1.删除虚拟机光驱</strong></p>
<p>此时，查看虚拟机详情页，可以看到我们刚才创建的 Debian 虚拟机。</p>
<p>删除 <code>CD/DVD驱动器</code> ：</p>
<a href="https://i0.hdslb.com/bfs/article/5d75f720455d76298a48dd10e80876da6a71b7f4.png@942w_495h_progressive.webp" alt="PVE虚拟机模板" data-fancybox="images" data-caption="PVE虚拟机模板" target="_blank" rel="nofollow"><img decoding="async" data-src="https://i0.hdslb.com/bfs/article/5d75f720455d76298a48dd10e80876da6a71b7f4.png@942w_495h_progressive.webp" src="http://158666.xyz/$loadimg_url" alt="PVE虚拟机模板"></a>
<p><strong>2.2.虚拟机导入磁盘镜像</strong></p>
<p>使用 SSH 工具登录 PVE 服务器，并进入 <code>tmp</code> 目录，逐条执行以下命令来创建一个文件夹：</p>
<pre><code class="language-shell"># 进入 tmp 目录
cd /tmp

# 创建文件夹
mkdir Debian

# 进入文件夹
cd Debian</code></pre>
<p>将 Debian 云镜像 <code>debian-11-genericcloud-amd64.qcow2</code> 上传到该文件夹中，并检查 <code>hash</code> ：</p>
<pre><code class="language-shell"># 检查文件是否存在
ls -la

# 计算文件 hash
sha512sum debian-11-genericcloud-amd64.qcow2</code></pre>
<p>确认无误后，将 Debian 云镜像导入刚才创建的虚拟机中，命令中的 <code>VM ID</code> 需要根据实际情况替换，演示为 <code>1000</code> ：</p>
<pre><code class="language-shell"># 将 qcow2 镜像导入虚拟机中
qm importdisk 1000 debian-11-genericcloud-amd64.qcow2 local-lvm

# 输出结果为以下类似内容表示成功
Successfully imported disk as &#039;unused0:local-lvm:vm-1000-disk-1&#039;</code></pre>
<a href="https://i0.hdslb.com/bfs/article/8a3dead8d8373c2d836b564f748653446c507da7.png@942w_492h_progressive.webp" alt="PVE虚拟机模板" data-fancybox="images" data-caption="PVE虚拟机模板" target="_blank" rel="nofollow"><img decoding="async" data-src="https://i0.hdslb.com/bfs/article/8a3dead8d8373c2d836b564f748653446c507da7.png@942w_492h_progressive.webp" src="http://158666.xyz/$loadimg_url" alt="PVE虚拟机模板"></a>
<p>鼠标 <strong>双击</strong> 该未使用的磁盘，勾选 <code>IO thread</code> ，点击添加按钮：</p>
<a href="https://i0.hdslb.com/bfs/article/a33d20532063b80a83c3cf2e9bcc6a60e9a68d1c.png@942w_503h_progressive.webp" alt="PVE虚拟机模板" data-fancybox="images" data-caption="PVE虚拟机模板" target="_blank" rel="nofollow"><img decoding="async" data-src="https://i0.hdslb.com/bfs/article/a33d20532063b80a83c3cf2e9bcc6a60e9a68d1c.png@942w_503h_progressive.webp" src="http://158666.xyz/$loadimg_url" alt="PVE虚拟机模板"></a>
<p>刚导入的磁盘只有 <code>2G</code> 磁盘空间，为了后续方便使用，先给磁盘扩容 <code>16G</code> 的磁盘空间。  </p>
<p>鼠标 <strong>单击</strong> 选中该磁盘，选择页面顶部 <code>Disk Action</code> 菜单的子菜单 <code>Resize</code> ：</p>
<a href="https://i0.hdslb.com/bfs/article/d5e0381ef7bd49f44a80eae3e4da6cbf15946cb6.png@942w_494h_progressive.webp" alt="PVE虚拟机模板" data-fancybox="images" data-caption="PVE虚拟机模板" target="_blank" rel="nofollow"><img decoding="async" data-src="https://i0.hdslb.com/bfs/article/d5e0381ef7bd49f44a80eae3e4da6cbf15946cb6.png@942w_494h_progressive.webp" src="http://158666.xyz/$loadimg_url" alt="PVE虚拟机模板"></a>
<p>在弹出的对话框中，给该磁盘增加 <code>16G</code> 磁盘空间：</p>
<a href="https://i0.hdslb.com/bfs/article/7e07e2d5175a780c7bd0a486233bc078f6e4ade8.png@942w_602h_progressive.webp" alt="PVE虚拟机模板" data-fancybox="images" data-caption="PVE虚拟机模板" target="_blank" rel="nofollow"><img decoding="async" data-src="https://i0.hdslb.com/bfs/article/7e07e2d5175a780c7bd0a486233bc078f6e4ade8.png@942w_602h_progressive.webp" src="http://158666.xyz/$loadimg_url" alt="PVE虚拟机模板"></a>
<p><strong>2.3.虚拟机添加CloudInit设备</strong>  </p>
<p>为了能够正确使用 Cloud-Init 初始化系统，需要给 Debian 虚拟机添加 <code>CloudInit设备</code> 。</p>
<p>点击顶部 <code>添加</code> 按钮，选择 <code>CloudInit设备</code> ：</p>
<a href="https://i0.hdslb.com/bfs/article/c1f1054eb37b2b0c5fad3ada86893601b0169925.png@942w_503h_progressive.webp" alt="PVE虚拟机模板" data-fancybox="images" data-caption="PVE虚拟机模板" target="_blank" rel="nofollow"><img decoding="async" data-src="https://i0.hdslb.com/bfs/article/c1f1054eb37b2b0c5fad3ada86893601b0169925.png@942w_503h_progressive.webp" src="http://158666.xyz/$loadimg_url" alt="PVE虚拟机模板"></a>
<p><code>总线/设备</code> 选择 <code>SCSI</code> ，编号为 <code>1</code> ，存储选择 <code>local-lvm</code> ：</p>
<a href="https://i0.hdslb.com/bfs/article/fa747062418b6fc1018fc3bef286ff896a188ae1.png@942w_630h_progressive.webp" alt="PVE虚拟机模板" data-fancybox="images" data-caption="PVE虚拟机模板" target="_blank" rel="nofollow"><img decoding="async" data-src="https://i0.hdslb.com/bfs/article/fa747062418b6fc1018fc3bef286ff896a188ae1.png@942w_630h_progressive.webp" src="http://158666.xyz/$loadimg_url" alt="PVE虚拟机模板"></a>
<p><strong>2.4.虚拟机添加串行端口</strong>  </p>
<p>有些云镜像需要用到 <code>serial</code> 端口作为视频输出端口，不然虚拟机无法启动，因此给 Debian 虚拟机添加串行端口。</p>
<p>点击顶部 <code>添加</code> 按钮，选择 <code>串行端口</code> ：</p>
<a href="https://i0.hdslb.com/bfs/article/5227eeec0f626779c01079e6ecd0e0d0319fbd01.png@942w_473h_progressive.webp" alt="PVE虚拟机模板" data-fancybox="images" data-caption="PVE虚拟机模板" target="_blank" rel="nofollow"><img decoding="async" data-src="https://i0.hdslb.com/bfs/article/5227eeec0f626779c01079e6ecd0e0d0319fbd01.png@942w_473h_progressive.webp" src="http://158666.xyz/$loadimg_url" alt="PVE虚拟机模板"></a>
<p>串行端口编号为 <code>0</code> ：</p>
<a href="https://i0.hdslb.com/bfs/article/55c1e9f3582672df28d24fabd5eb5f629b022982.png@942w_594h_progressive.webp" alt="PVE虚拟机模板" data-fancybox="images" data-caption="PVE虚拟机模板" target="_blank" rel="nofollow"><img decoding="async" data-src="https://i0.hdslb.com/bfs/article/55c1e9f3582672df28d24fabd5eb5f629b022982.png@942w_594h_progressive.webp" src="http://158666.xyz/$loadimg_url" alt="PVE虚拟机模板"></a>
<p>虚拟机硬件设备修改完成后，如下图所示：</p>
<a href="https://i0.hdslb.com/bfs/article/11c3903d2e7655833e1dfbcec2179f395550a9a9.png@942w_474h_progressive.webp" alt="PVE虚拟机模板" data-fancybox="images" data-caption="PVE虚拟机模板" target="_blank" rel="nofollow"><img decoding="async" data-src="https://i0.hdslb.com/bfs/article/11c3903d2e7655833e1dfbcec2179f395550a9a9.png@942w_474h_progressive.webp" src="http://158666.xyz/$loadimg_url" alt="PVE虚拟机模板"></a>
<h1>3.调整虚拟机配置参数</h1>
<p>进入左侧虚拟机 <code>选项</code> 菜单，可以看到当前虚拟机的配置参数。</p>
<p>通常情况下，Debian 虚拟机的配置参数需要修改以下几个：</p>
<ol>
<li>
<p>开机自启动（模板无需修改，克隆的虚拟机需要修改）</p>
</li>
<li>
<p>启动/关机顺序（模板无需修改，克隆的虚拟机需要修改）</p>
</li>
<li>
<p>引导顺序（仅模板需要修改）</p>
</li>
<li>
<p>使用平板指针（仅模板需要修改）</p>
</li>
</ol>
<p><strong>3.1.修改引导顺序</strong></p>
<p>鼠标 <strong>双击</strong> <code>引导顺序</code> 选项，进入编辑界面。</p>
<p>在 <code>scsi0</code> 设备处，勾选前面的 “已启用” 复选框，并使用行首的排序功能，将该设备拖拽到第一个。然后点击 <code>OK</code> 按钮：</p>
<a href="https://i0.hdslb.com/bfs/article/d64c63a04816fd25d65274fc0d8566d8f2a6f0b8.png@942w_606h_progressive.webp" alt="PVE虚拟机模板" data-fancybox="images" data-caption="PVE虚拟机模板" target="_blank" rel="nofollow"><img decoding="async" data-src="https://i0.hdslb.com/bfs/article/d64c63a04816fd25d65274fc0d8566d8f2a6f0b8.png@942w_606h_progressive.webp" src="http://158666.xyz/$loadimg_url" alt="PVE虚拟机模板"></a>
<p><strong>3.2.修改平板指针设置</strong></p>
<p>关闭 <code>使用平板指针</code> 选项，可以一定程度上降低虚拟机的 CPU 使用率。</p>
<a href="https://i0.hdslb.com/bfs/article/c71920a336387f8bb1b7a5f59683dc27ca1d27db.png@942w_708h_progressive.webp" alt="PVE虚拟机模板" data-fancybox="images" data-caption="PVE虚拟机模板" target="_blank" rel="nofollow"><img decoding="async" data-src="https://i0.hdslb.com/bfs/article/c71920a336387f8bb1b7a5f59683dc27ca1d27db.png@942w_708h_progressive.webp" src="http://158666.xyz/$loadimg_url" alt="PVE虚拟机模板"></a>
<h1>4.设置Cloud-Init</h1>
<p>进入左侧虚拟机 <code>Cloud-Init</code> 菜单，可以看到当前虚拟机的初始化参数。</p>
<p>根据之前的网络规划，内网的 IP 地址段为 <code>172.16.1.0/24</code> ，因此 Debian 虚拟机模板的参数如下：</p>
<a href="https://i0.hdslb.com/bfs/article/bddb1e4705dadd07d89dad90a56b39337c04775c.png@942w_318h_progressive.webp" alt="PVE虚拟机模板" data-fancybox="images" data-caption="PVE虚拟机模板" target="_blank" rel="nofollow"><img decoding="async" data-src="https://i0.hdslb.com/bfs/article/bddb1e4705dadd07d89dad90a56b39337c04775c.png@942w_318h_progressive.webp" src="http://158666.xyz/$loadimg_url" alt="PVE虚拟机模板"></a>
<p><strong>说明：</strong></p>
<p>修改 <code>Cloud-Init</code> 参数时，需要在虚拟机关机情况下修改才会生效。</p>
<p>在 <code>DNS服务器</code> 设置部分，如果先设置了 <code>127.0.0.1</code> 作为虚拟机 DNS 服务器，后续其他 DNS 的 IP 地址将被虚拟机忽略。</p>
<p>此时内网没有其他 DNS 服务器存在，因此 <code>DNS服务器</code> 先设置为 <code>172.16.1.1 fc00::1</code> ，IP 之间用空格隔开。</p>
<p>在使用 Debian 模板克隆出新虚拟机之后，再对新虚拟机调整 IP 设置比较好。</p>
<p><code>Cloud-Init</code> 的 <code>IP配置</code> ，如下图所示：</p>
<a href="https://i0.hdslb.com/bfs/article/ce0dd7eb9e1edfccb066e26147b937650023fe28.png@942w_525h_progressive.webp" alt="PVE虚拟机模板" data-fancybox="images" data-caption="PVE虚拟机模板" target="_blank" rel="nofollow"><img decoding="async" data-src="https://i0.hdslb.com/bfs/article/ce0dd7eb9e1edfccb066e26147b937650023fe28.png@942w_525h_progressive.webp" src="http://158666.xyz/$loadimg_url" alt="PVE虚拟机模板"></a>
<p>设置完成后，Debian 虚拟机必要参数全部设置完成，可以将该虚拟机开机。</p>
<h1>1.配置Debian系统</h1>
<p>此时可以将 Debian 虚拟机开机，并使用 <code>Cloud-Init</code> 中设置的账号密码进行登录。</p>
<p><strong>1.1.启用SSH密码登录</strong></p>
<p>因为 Debian 的云镜像默认使用秘钥登录，因此切换到左侧菜单的 <code>控制台</code> 进行操作：</p>
<a href="https://i0.hdslb.com/bfs/article/25b2a72f67ecb80eef32a51fd096594269a3189a.png@942w_717h_progressive.webp" alt="PVE虚拟机模板" data-fancybox="images" data-caption="PVE虚拟机模板" target="_blank" rel="nofollow"><img decoding="async" data-src="https://i0.hdslb.com/bfs/article/25b2a72f67ecb80eef32a51fd096594269a3189a.png@942w_717h_progressive.webp" src="http://158666.xyz/$loadimg_url" alt="PVE虚拟机模板"></a>
<p>在 Debian 虚拟机的命令行界面，使用 <code>nano</code> 编辑器编辑 <code>sshd</code> 服务的配置文件，执行以下命令：</p>
<pre><code class="language-shell">## 编辑 ssh 配置文件
sudo nano /etc/ssh/sshd_config.d/server_sshd.conf</code></pre>
<p>在编辑器对话框中输入以下内容，注意命令中间的空格：</p>
<pre><code class="language-shell">PasswordAuthentication yes

PermitEmptyPasswords no

UseDNS no</code></pre>
<p><code>nano</code> 编辑器常用操作如下：  </p>
<ul>
<li>
<p>在编辑文件时，可以用键盘 <code>方向键</code> 移动光标位置</p>
</li>
<li>
<p>在保存文件时，按下键盘 <code>ctrl 和 x</code> 组合键，先按下键盘 <code>y</code> 键，再按下键盘 enter 键，即可保存</p>
</li>
</ul>
<p>然后，重启 SSH 服务：</p>
<pre><code class="language-shell">## 重启 sshd
sudo systemctl restart ssh.service</code></pre>
<p>就可以像往常一样，通过 SSH 工具远程访问 Debian 虚拟机了。</p>
<p><strong>1.2.配置系统软件源</strong></p>
<pre><code>bash &lt;(curl -sSL https://gitee.com/SuperManito/LinuxMirrors/raw/main/ChangeMirrors.sh)</code></pre>
<p>接下来安装系统必要软件，逐条执行以下命令：</p>
<pre><code class="language-shell">## 安装系统软件
sudo apt install qemu-guest-agent zsh git curl htop lm-sensors vim tmux nftables sshguard

## 安装网络工具
sudo apt install iperf iperf3 iftop lsof ldnsutils dhcpcd5

## 安装 snap
sudo apt install snapd

## 安装 Adguard Home
sudo snap install adguard-home

## 写入磁盘
sudo sync</code></pre>
<p><strong>1.3.调整系统时间</strong>  </p>
<p>默认情况下的 Debian 云镜像的系统时间可能不正确，执行以下命令将系统时区设置为中国时区：</p>
<pre><code class="language-shell">## 设置系统时区
sudo timedatectl set-timezone Asia/Shanghai</code></pre>
<p>设置完成后，执行以下命令检查系统时间：</p>
<pre><code class="language-shell">## 检查系统时区
date -R</code></pre>
<p>Debian 普通镜像常用 <code>systemd-timesyncd.service</code> 来同步时间，而 Debian 云镜像使用 <code>chrony.service</code> 来同步时间。  </p>
<p>为了使用国内的 NTP 服务器，需要对 <code>chrony.service</code> 进行配置。</p>
<p>执行以下命令对 <code>chrony</code> 的配置文件进行修改：</p>
<pre><code class="language-shell">## 编辑 chrony 配置文件
sudo nano /etc/chrony/chrony.conf</code></pre>
<p>在编辑器对话框中，将 <code>pool 2.debian.pool.ntp.org iburst</code> 这行内容 “注释” 掉，并添加国内的 NTP 服务器，参考如下内容：</p>
<pre><code class="language-shell">## chrony 服务配置文件示例

# Use Debian vendor zone.
# pool 2.debian.pool.ntp.org iburst    ## 在这行前面增加注释符 # 来注释

# Use Custom vendor zone.
pool ntp.tencent.com iburst
pool ntp.aliyun.com iburst</code></pre>
<p>保存该配置文件后，重启 <code>chrony</code> 服务：</p>
<pre><code class="language-shell">## 重启 chrony 服务
sudo systemctl restart chrony.service</code></pre>
<p>再检查系统 NTP 服务器是否被正确修改：</p>
<pre><code class="language-shell">## 检查系统 NTP 服务器
chronyc sources -V</code></pre>
<p>如果输出以下类似内容，则表示系统 NTP 服务设置正确：</p>
<pre><code class="language-shell">## NTP 服务示例输出

MS Name/IP address         Stratum Poll Reach LastRx Last sample
===============================================================================
^+ 139.199.215.251               2  10   177   244  -1669us[-1757us] +/-   67ms
^* 203.107.6.88                  2  10   377   105  -1005us[-1094us] +/-   19ms</code></pre>
<p><strong>1.4.配置ZSH</strong></p>
<p><code>Zsh</code> 是比 <code>Bash</code> 好用的 <code>Shell</code> 程序，使用 <code>oh-my-zsh</code> 进行配置：<br>
在1.2节安装系统必要软件中已安装zsh。</p>
<p><a href="https://sysin.org/blog/linux-zsh-all/#%E5%87%86%E5%A4%87-zsh-2" target="_blank" rel="nofollow">Linux 全局安装配置 zsh + oh-my-zsh - sysin | SYStem INside | 软件与技术分享</a></p>
<p><strong>1.11.清理系统</strong></p>
<p>Debian 模板虚拟机已经配置完成，在将其转换为模板前需要对系统进行清理。</p>
<p>逐条执行以下命令，注意命令中的空格：</p>
<pre><code class="language-shell">## 清理系统软件包
sudo apt clean &amp;&amp; sudo apt autoclean &amp;&amp; sudo apt autoremove --purge

## 清理系统缓存
sudo rm -rvf /var/cache/apt/* /var/lib/apt/lists/* /tmp/*

## 清理系统日志
sudo find /var/log/ -type f | xargs sudo rm -rvf

## 清理命令历史记录文件
rm -rvf ~/.bash_history ~/.zsh_history

## 清理命令历史
history -c</code></pre>
<h1>2.虚拟机转为模板</h1>
<p>将 Debian 模板虚拟机关机，并进入 PVE 的 WEB 管理界面。</p>
<p>在虚拟机列表中，鼠标 <strong>右键单击</strong> Debian 模板虚拟机，在弹出的菜单中选择 <code>转换成模板</code> ：</p>
<a href="https://i0.hdslb.com/bfs/article/1f3eaff380259696f315ea91008397d3f6b665e0.png@942w_719h_progressive.webp" alt="PVE虚拟机模板" data-fancybox="images" data-caption="PVE虚拟机模板" target="_blank" rel="nofollow"><img decoding="async" data-src="https://i0.hdslb.com/bfs/article/1f3eaff380259696f315ea91008397d3f6b665e0.png@942w_719h_progressive.webp" src="http://158666.xyz/$loadimg_url" alt="PVE虚拟机模板"></a>
<p>需要说明的是，虚拟机 <code>转换成模板</code> 的操作是不可逆的。</p>
<p>如果某些 Debian 系统的配置项有问题，只能在用该模板克隆出来的新虚拟机中进行修改，或者删除并重新制作模板。</p>
<h1>3.额外说明</h1>
<p>本文中 Debian 云镜像的系统配置方法大多也适用于 Debian 普通镜像。</p>
<p>但有关 IP 地址、DNS、系统时区等内容的配置方法在 Debian 普通镜像上有区别。</p>
<p>而且，如果使用 Debian 普通镜像制作虚拟机模板，建议不要使用 <code>Cloud-Init</code> ，以避免某些配置发生变化。</p>
<p>使用 Debian ISO 镜像安装完操作系统后，修改网卡 IP 地址配置，需要执行以下命令：</p>
<pre><code class="language-shell">## Debian 普通镜像调整网卡配置
sudo vim /etc/network/interfaces</code></pre>
<p>在网卡的配置文件中需要修改 <code>address</code> 、 <code>dns-nameservers</code> 等参数，完整配置文件参考如下：</p>
<pre><code class="language-shell"># This file describes the network interfaces available on your system
# and how to activate them. For more information, see interfaces(5).

source /etc/network/interfaces.d/*

# The loopback network interface
auto lo
iface lo inet loopback

# The primary network interface
allow-hotplug ens18
iface ens18 inet static
    address 172.16.1.2/24
    gateway 172.16.1.1
    # dns-* options are implemented by the resolvconf package, if installed
    dns-nameservers 172.16.1.3
    dns-search fox.lab</code></pre>
<p>检查系统的 <code>hosts</code> ，执行以下命令：</p>
<pre><code class="language-shell">## 检查系统 hosts
cat /etc/hosts

## 示例输出

127.0.0.1   localhost
172.16.1.2  dns001.fox.lab  dns001

# The following lines are desirable for IPv6 capable hosts
::1     localhost ip6-localhost ip6-loopback
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters</code></pre>
<p>Debian 普通镜像需要手动修改系统 DNS 配置，执行以下命令：</p>
<pre><code class="language-shell">## Debian 普通镜像修改系统 DNS
sudo vim /etc/resolv.conf</code></pre>
<p>在编辑器对话框中输入以下内容，注意命令中间的空格：</p>
<pre><code class="language-shell">search fox.lab
nameserver 172.16.1.3
nameserver fc00::3
nameserver 127.0.0.1</code></pre>
<p>Debian 普通镜像使用 <code>systemd-timesyncd.service</code> 来同步系统时间，检查服务状态：</p>
<pre><code class="language-shell">## 检查 Debian 普通镜像 NTP 服务器状态
sudo systemctl status systemd-timesyncd.service</code></pre>
<p>调整 NTP 服务，逐条执行以下命令：</p>
<pre><code class="language-shell">## 创建 NTP 配置文件的文件夹
sudo mkdir /etc/systemd/timesyncd.conf.d

## 创建 NTP 配置文件
sudo nano /etc/systemd/timesyncd.conf.d/server_ntp.conf</code></pre>
<p>在 nano 编辑器对话框中输入以下内容，并保存：</p>
<pre><code class="language-shell">[Time]
NTP=ntp.tencent.com ntp.aliyun.com</code></pre>
<p>重启 NTP 服务：</p>
<pre><code class="language-shell">## 重启 NTP 服务
sudo systemctl restart systemd-timesyncd.service</code></pre>
					    	        </div>
			
				<div class="tags my-2">
									</div>
    	        			     
				    	    </div>
			</div>
    	    <div class="single-top-area text-sm clearfix card mt-4">
					
    	    	<div class="card-body"> 
    	            <strong>版权声明：</strong><a href="http://158666.xyz/author/2" title="导航站">xonec</a> 发表于 2023-06-12 18:23:10。<br>
    	            <strong>转载请注明：</strong><a href="http://158666.xyz/1124.html" rel="bookmark" title="本文固定链接 https://dh.158666.xyz/1124.html">PVE虚拟机模板 | 导航站</a>
    	    	</div>
					
    	    </div>
    	    <div class="near-navigation rounded mt-4 py-2">
    	    	    	    	    	    	<div class="nav previous border-right border-color">
    	            <a class="near-permalink" href="http://158666.xyz/1122.html">
    	    		<span>上一篇</span>
    	    		<h4 class="near-title">在Proxmox VE 7.1 中开启vGPU_unlock，实现显卡虚拟化</h4>
    	    		</a>
    	    	</div>
    	    	    	    	    	    	<div class="nav none border-left border-color" style="text-align: right;">
    	    		<span>下一篇</span>
    	    		<h4 class="near-title">没有更多了...</h4>	
    	    	</div>
    	    	    	    </div>
    	    
<!-- comments -->
<div id="comments" class="comments">
	<h1 id="comments-list-title" class="comments-title h5 mx-1 my-4">
		<i class="iconfont icon-comment"></i>
		<span class="noticom">
			<a href="http://158666.xyz/1124.html#respond" class="comments-title">暂无评论</a> 
		</span>
	</h1> 
	<div class="card">
		<div class="card-body"> 
						<div id="respond_box">
				<div id="respond" class="comment-respond">
					    				<form action="https://dh.158666.xyz/wp-comments-post.php" method="post" id="commentform" class="text-sm mb-4">	
						<div class="visitor-avatar d-flex flex-fill mb-2">
														<img class="v-avatar rounded-circle" src="http://158666.xyz/wp-content/themes/webstackpro/images/gravatar.jpg">
													</div> 
						<div class="comment-textarea mb-3">
							<textarea name="comment" id="comment" class="form-control" placeholder="输入评论内容..." tabindex="4" cols="50" rows="3"></textarea>
						</div>
							
						<div id="comment-author-info" class="row  row-sm">
							<div class="col-sm-6 col-lg-4 mb-3"><input type="text" name="author" id="author" class="form-control" value="" size="22" placeholder="昵称" tabindex="2"></div>	
							<div class="col-sm-6 col-lg-4 mb-3"><input type="text" name="email" id="email" class="form-control" value="" size="22" placeholder="邮箱" tabindex="3"></div>
							<div class="col-sm-12 col-lg-4 mb-3"><input type="text" name="url" id="url" class="form-control" value="" size="22" placeholder="网址" tabindex="4"></div>
						</div>
												<div class="com-footer text-right">
							<input type="hidden" id="_wpnonce" name="_wpnonce" value="a13019c435"><input type="hidden" name="_wp_http_referer" value="/1124.html?simply_static_page=33">							<a rel="nofollow" id="cancel-comment-reply-link" style="display: none;" href="javascript:;" class="btn btn-light custom_btn-outline mx-2">再想想</a>
														<input class="btn btn-dark custom_btn-d" name="submit" type="submit" id="submit" tabindex="5" value="发表评论">
														<input type="hidden" name="comment_post_ID" value="1124" id="comment_post_ID">
<input type="hidden" name="comment_parent" id="comment_parent" value="0">
						</div>
						    				</form>
					<div class="clear"></div>
    				  				</div>
  			</div>	
						<div id="loading-comments"><span></span></div>
						<div class="not-comment card"><div class="card-body nothing text-center color-d">暂无评论...</div></div>
					
		</div>	
	</div>
</div>
<!-- comments end -->
		</div> 
		<div class="sidebar col-lg-4 pl-xl-4 d-none d-lg-block">
			

	
			<div id="about_author-7" class="card about_author">
		
	<div class="widget-author-cover">
		<div class="media media-2x1">
                        <div class="media-content" data-src="https://i.loli.net/2020/01/11/wHoOcfQGhqvlUkd.jpg"></div>
            		</div>
		<div class="widget-author-avatar">  
			<div class="flex-avatar"> 
			<img alt="" src="https://cn.gravatar.com/avatar/6da082c2b9cf56fb1cfaacd00fbc7b51?s=80&#038;d=retro&#038;r=g" srcset="https://cn.gravatar.com/avatar/6da082c2b9cf56fb1cfaacd00fbc7b51?s=160&#038;d=retro&#038;r=g 2x" class="avatar avatar-80 photo" height="80" width="80" decoding="async">	 
	  		</div>	 
	  	</div>
  	</div>
    <div class="widget-author-meta text-center p-4">
      	<div class="h6 mb-3">xonec<small class="d-block">
			<span class="badge badge-outline-primary mt-2">
			    博主			</span></small>
		</div>
      	<div class="desc text-xs mb-3 overflowClip_2"></div>
	    <div class="row no-gutters text-center">
	      	<a href="http://158666.xyz/author/2" target="_blank" class="col">
	        	<span class="font-theme font-weight-bold text-md">9</span><small class="d-block text-xs text-muted">文章</small>
	      	</a>
	      	<a href="http://158666.xyz/author/2" target="_blank" class="col">
	        	<span class="font-theme font-weight-bold text-md">0</span><small class="d-block text-xs text-muted">评论</small>
	      	</a>
	      	<a href="http://158666.xyz/author/2" target="_blank" class="col">
	        	<span class="font-theme font-weight-bold text-md">34,278</span><small class="d-block text-xs text-muted">浏览</small>
	      	</a>
	      	<a href="http://158666.xyz/author/2" target="_blank" class="col">
	        	<span class="font-theme font-weight-bold text-md">2,797</span><small class="d-block text-xs text-muted">获赞</small>
	      	</a>
	    </div>
	</div>

	
	</div>
<div id="hot_comment-12" class="card hot_comment">
<div class="card-header widget-header"><span><i class="mr-2 iconfont icon-hot"></i>热评文章</span></div>
	
	<div class="card-body"> 
		<div class="list-grid list-rounded my-n2">
				
								<div class="list-item py-2">
										<div class="media media-3x2 rounded col-4 mr-3">
            	                    	        <a class="media-content" href="http://158666.xyz/1128.html" title="hexo+netlify+Qexo后端+github自动化" data-src="https://b2.kwxn.eu.org/hexonews/2022/12/d78fdf0a560ca5ccdef4aea9e7561188.jpg"></a>
            	        					</div>
										<div class="list-content py-0">
						<div class="list-body">
							<a href="http://158666.xyz/1128.html" class="list-title overflowClip_2" rel="bookmark">hexo+netlify+Qexo后端+github自动化</a>
						</div>
						<div class="list-footer">
							<div class="d-flex flex-fill text-muted text-xs">
								<time class="d-inline-block">5小时前</time>
								<div class="flex-fill"></div>
								<span class="discuss"><i class="iconfont icon-comment"></i> 0</span>
							</div>
						</div>
					</div>
				</div> 
								<div class="list-item py-2">
										<div class="media media-3x2 rounded col-4 mr-3">
            	                    	        <a class="media-content" href="http://158666.xyz/1114.html" title="群晖docker部署bitwarden(vaultwarden)、反向代理与浏览器、iOS设置" data-src="https://picoe.oss-cn-hangzhou.aliyuncs.com/img/638ad47808074742.png_e1080.jpg"></a>
            	        					</div>
										<div class="list-content py-0">
						<div class="list-body">
							<a href="http://158666.xyz/1114.html" class="list-title overflowClip_2" rel="bookmark">群晖docker部署bitwarden(vaultwarden)、反向代理与浏览器、iOS设置</a>
						</div>
						<div class="list-footer">
							<div class="d-flex flex-fill text-muted text-xs">
								<time class="d-inline-block">5小时前</time>
								<div class="flex-fill"></div>
								<span class="discuss"><i class="iconfont icon-comment"></i> 0</span>
							</div>
						</div>
					</div>
				</div> 
								<div class="list-item py-2">
										<div class="media media-3x2 rounded col-4 mr-3">
            	                    	        <a class="media-content" href="http://158666.xyz/1116.html" title="PVE的local和local-lvm" data-src="https://foxi.buduanwang.vip/wp-content/uploads/2021/09/QQ%E6%88%AA%E5%9B%BE20210927104722.png"></a>
            	        					</div>
										<div class="list-content py-0">
						<div class="list-body">
							<a href="http://158666.xyz/1116.html" class="list-title overflowClip_2" rel="bookmark">PVE的local和local-lvm</a>
						</div>
						<div class="list-footer">
							<div class="d-flex flex-fill text-muted text-xs">
								<time class="d-inline-block">5小时前</time>
								<div class="flex-fill"></div>
								<span class="discuss"><i class="iconfont icon-comment"></i> 0</span>
							</div>
						</div>
					</div>
				</div> 
								<div class="list-item py-2">
										<div class="media media-3x2 rounded col-4 mr-3">
            	                    	        <a class="media-content" href="http://158666.xyz/1118.html" title="PVE的优化过程" data-src="https://i.loli.net/2020/01/16/95Xzaj7x4OVKqFv.jpg"></a>
            	        					</div>
										<div class="list-content py-0">
						<div class="list-body">
							<a href="http://158666.xyz/1118.html" class="list-title overflowClip_2" rel="bookmark">PVE的优化过程</a>
						</div>
						<div class="list-footer">
							<div class="d-flex flex-fill text-muted text-xs">
								<time class="d-inline-block">5小时前</time>
								<div class="flex-fill"></div>
								<span class="discuss"><i class="iconfont icon-comment"></i> 0</span>
							</div>
						</div>
					</div>
				</div> 
								<div class="list-item py-2">
										<div class="media media-3x2 rounded col-4 mr-3">
            	                    	        <a class="media-content" href="http://158666.xyz/1120.html" title="国光的vGPU教程" data-src="https://image.3001.net/images/20230112/16734940272580.png"></a>
            	        					</div>
										<div class="list-content py-0">
						<div class="list-body">
							<a href="http://158666.xyz/1120.html" class="list-title overflowClip_2" rel="bookmark">国光的vGPU教程</a>
						</div>
						<div class="list-footer">
							<div class="d-flex flex-fill text-muted text-xs">
								<time class="d-inline-block">5小时前</time>
								<div class="flex-fill"></div>
								<span class="discuss"><i class="iconfont icon-comment"></i> 0</span>
							</div>
						</div>
					</div>
				</div> 
									</div>
	</div>

	</div>
<div id="hot_post_img-3" class="card hot_post_img">
<div class="card-header widget-header"><span><i class="mr-2 iconfont icon-chart-pc"></i>热门文章</span></div>
	
	
	<div class="card-body"> 
		<div class="list-grid list-rounded my-n2">
		    		</div>
	</div>

	</div>
<div id="cx_tag_cloud-8" class="card cx_tag_cloud">
<div class="card-header widget-header"><span><i class="mr-2 iconfont icon-tags"></i>热门标签</span></div> 
		
		<div class="card-body">
		<div class="tags text-justify">
			 
				<a href="http://158666.xyz/apptag/yizhi" title="益智" class="tag-yizhi color-5">
				益智<span>(3)</span></a>
			 
				<a href="http://158666.xyz/apptag/%e7%a4%be%e4%ba%a4" title="社交" class="tag-%e7%a4%be%e4%ba%a4 color-6">
				社交<span>(1)</span></a>
			 
				<a href="http://158666.xyz/apptag/jiemi" title="解密" class="tag-jiemi color-6">
				解密<span>(1)</span></a>
			 
				<a href="http://158666.xyz/apptag/xiuxian" title="休闲" class="tag-xiuxian color-2">
				休闲<span>(1)</span></a>
			 
				<a href="http://158666.xyz/tag/%e6%a0%b8%e6%b3%84%e6%bc%8f" title="核泄漏" class="tag-%e6%a0%b8%e6%b3%84%e6%bc%8f color-7">
				核泄漏<span>(0)</span></a>
			 
				<a href="http://158666.xyz/tag/%e5%81%a5%e5%ba%b7" title="健康" class="tag-%e5%81%a5%e5%ba%b7 color-4">
				健康<span>(0)</span></a>
			 
				<a href="http://158666.xyz/tag/%e7%94%9f%e5%91%bd%e8%b5%b7%e6%ba%90" title="生命起源" class="tag-%e7%94%9f%e5%91%bd%e8%b5%b7%e6%ba%90 color-0">
				生命起源<span>(0)</span></a>
			 
				<a href="http://158666.xyz/tag/%e6%9c%9b%e8%bf%9c%e9%95%9c" title="望远镜" class="tag-%e6%9c%9b%e8%bf%9c%e9%95%9c color-4">
				望远镜<span>(0)</span></a>
			 
				<a href="http://158666.xyz/tag/%e9%bb%91%e6%b4%9e" title="黑洞" class="tag-%e9%bb%91%e6%b4%9e color-7">
				黑洞<span>(0)</span></a>
			 
				<a href="http://158666.xyz/tag/%e7%89%9b%e9%a1%bf" title="牛顿" class="tag-%e7%89%9b%e9%a1%bf color-8">
				牛顿<span>(0)</span></a>
			 
				<a href="http://158666.xyz/tag/%e5%8a%9b%e5%ad%a6" title="力学" class="tag-%e5%8a%9b%e5%ad%a6 color-4">
				力学<span>(0)</span></a>
			 
				<a href="http://158666.xyz/tag/%e5%bc%95%e5%8a%9b%e6%b3%a2" title="引力波" class="tag-%e5%bc%95%e5%8a%9b%e6%b3%a2 color-0">
				引力波<span>(0)</span></a>
			 
				<a href="http://158666.xyz/tag/%e5%ae%87%e5%ae%99" title="宇宙" class="tag-%e5%ae%87%e5%ae%99 color-8">
				宇宙<span>(0)</span></a>
			 
		</div>
		</div>

	</div>	
	
		</div>
	</div> 
</div>
             
            <footer class="main-footer footer-type-1 text-xs">
                <div id="footer-tools" class="d-flex flex-column">
                    <a href="javascript:" id="go-to-up" class="btn rounded-circle go-up m-1" rel="go-top">
                        <i class="iconfont icon-to-up"></i>
                    </a>
                                                            <a href="javascript:" id="switch-mode" class="btn rounded-circle switch-dark-mode m-1" data-toggle="tooltip" data-placement="left" title="夜间模式">
                        <i class="mode-ico iconfont icon-light"></i>
                    </a>
                </div>
                <div class="footer-inner">
                    <div class="footer-text">
                                                Copyright © 2023 导航站                         &nbsp;&nbsp;Design by <a href="https://www.iowen.cn/" target="_blank"><strong>一为</strong></a>&nbsp;&nbsp;                                            </div>
                </div>
            </footer>
        </div>
<!-- main-content end -->
    </div>
<!-- page-container end -->
<script type="text/javascript" id="popper-js-extra">
/* <![CDATA[ */
var theme = {"ajaxurl":"http:\/\/158666.xyz\/wp-admin\/admin-ajax.php","addico":"http:\/\/158666.xyz\/wp-content\/themes\/webstackpro\/images\/add.png","order":"desc","formpostion":"top","defaultclass":"","isCustomize":"","icourl":"https:\/\/api.iowen.cn\/favicon\/","icopng":".png","urlformat":"1","customizemax":"10","newWindow":"1","lazyload":"1","minNav":"","loading":""};
/* ]]> */
</script>
<script type="text/javascript" src="http://158666.xyz/wp-content/themes/webstackpro/js/popper.min.js?ver=2.0406" id="popper-js"></script>
<script type="text/javascript" src="http://158666.xyz/wp-content/themes/webstackpro/js/bootstrap.min.js?ver=2.0406" id="bootstrap-js"></script>
<script type="text/javascript" src="http://158666.xyz/wp-content/themes/webstackpro/js/theia-sticky-sidebar.js?ver=2.0406" id="sidebar-js"></script>
<script type="text/javascript" src="http://158666.xyz/wp-content/themes/webstackpro/js/lazyload.min.js?ver=2.0406" id="lazyload-js"></script>
<script type="text/javascript" src="http://158666.xyz/wp-content/themes/webstackpro/js/jquery.fancybox.min.js?ver=2.0406" id="lightbox-js-js"></script>
<script type="text/javascript" src="http://158666.xyz/wp-content/themes/webstackpro/js/app.js?ver=2.0406" id="appjs-js"></script>
<script type="text/javascript" src="https://ssl.captcha.qq.com/TCaptcha.js?ver=2.0406" id="captcha-js"></script>
<script type="text/javascript" src="http://158666.xyz/wp-includes/js/comment-reply.min.js?ver=6.2.2" id="comment-reply-js"></script>
<script type="text/javascript" src="http://158666.xyz/wp-content/themes/webstackpro/js/comments-ajax.js?ver=2.0406" id="comments-ajax-js"></script>
    <script type="text/javascript">$(document).on('click','a.smooth-n',function(ev) {
        ev.preventDefault();
        $("html, body").animate({
            scrollTop: $($(this).attr("href")).offset().top - 90
        }, {
            duration: 500,
            easing: "swing"
        });
    });</script>
<!-- 自定义代码 -->
<!-- end 自定义代码 -->
</body>
</html>